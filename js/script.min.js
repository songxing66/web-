/*! grunt-test2-v1.0.0.js 2016-03-03 */
$(function(){function a(a){var b="";return b=a.toString(16),b.length<2&&(b="0"+b),b}function b(a,b,c){y=x.getContext("2d"),y.drawImage(a,b,c)}function c(b,c){$(".color-list").css({border:"1px solid #333333","box-shadow":"none"}),$("div[data-dash-line]").show();var d=$("#drash-X"),e=$("#drash-Y"),f=$("#drsh-info");f.show(),r=b.offsetX-2,s=b.offsetY-2,C=r,D=s;for(var g=c.offset(),h=Math.floor(b.pageX-g.left)-2,i=Math.floor(b.pageY-g.top)-2,j=y.getImageData(h,i,1,1),k=j.data,l=y.getImageData(h-7,i-7,15,15),m=l.data,n=0;B>n;n++)localpixelColor="rgb("+m[4*n+0]+","+m[4*n+1]+","+m[4*n+2]+")",$("#color-peix").find("li").eq(n).css("background-color",localpixelColor);u="rgb("+k[0]+","+k[1]+","+k[2]+")",v=a(k[0])+a(k[1])+a(k[2]),F=v,t="#"+v,d.css("top",s),e.css("left",r),y.strokeStyle="rgba(0,0,0,0.3)",y.fillStyle="rgba(255,255,255,0.6)",y.font="14px Arial",128>p-r&&s>48?f.css({left:r-128,top:s-38}):p-r>128&&48>s?f.css({left:r+12,top:s+12}):128>p-r&&48>s?f.css({left:r-128,top:s+12}):f.css({left:r+12,top:s-38}),f.find(".color-info-text").text("X:"+r+",Y:"+s),f.find(".color-info-box").css("background",t),$("div[data-piex-info]").text(r+","+s+","+u+" , "+t)}function d(){var a=$("aside[data-colorlist]");"true"==a.attr("data-hidden")?(a.css("right",0),a.attr("data-hidden","false"),$(".draw").css({width:"calc(100% - 260px)"})):(a.css("right","-260px"),a.attr("data-hidden","true"),$(".draw").css({width:"100%"}))}function e(a){w&&a&&(E?($("#color-list"+a).attr("data-has","true"),$("#color-list"+a).find("input[data-color-input]").val(C+", "+D+", 0x"+F),$("#color-list"+a).find("span[data-color-show]").css("background-color","#"+F)):($("#color-list"+a).attr("data-has","true"),$("#color-list"+a).find("input[data-color-input]").val(r+", "+s+", 0x"+v),$("#color-list"+a).find("span[data-color-show]").css("background-color","#"+v)))}function f(a){var b;switch(a){case 49:b=1;break;case 50:b=2;break;case 51:b=3;break;case 52:b=4;break;case 53:b=5;break;case 54:b=6;break;case 55:b=7;break;case 56:b=8;break;case 57:b=9;break;case 48:b=10;break;default:b=!1}return b}function g(a){a.parent(".mycolorliin").attr("data-has","false"),a.siblings("input[data-color-input]").val(""),a.siblings("span[data-color-show]").css("background-color","")}function h(){$(".mycolorliin").attr("data-has","false"),$("input[data-color-input]").val(""),$("span[data-color-show]").css("background-color","")}function i(a){var c=0,d=3;if(null!=n){var e=n.height,f=n.width,g=n.getAttribute("step");null==g&&(g=c),"right"==a?(g++,g>d&&(g=c)):(g--,c>g&&(g=d)),n.setAttribute("step",g);var h=90*g*Math.PI/180;switch(g){case 0:x.width=f+2,x.height=e+2,z=0,A=0;break;case 1:x.width=e+2,x.height=f+2,y.rotate(h),z=0,A=-e;break;case 2:x.width=f+2,x.height=e+2,y.rotate(h),z=-f,A=-e;break;case 3:x.width=e+2,x.height=f+2,y.rotate(h),z=-f,A=0}o.css({width:x.width+"px",height:x.height+"px"}),b(n,z,A),o.width=x.width,o.height=x.height,p=x.width,q=x.height}}function j(a){var b,c=a.id;return"sclea-left"==c?b="left":"sclea-right"==c&&(b="right"),b}function k(){for(var a="",b="",c="",d=[],e=[],f=[],g=$("li[data-has=true]").find("input[data-color-input]"),h=0;h<g.length;h++){var i=$(g[h]).val();f=i.split(","),e.push(f),d.push(i),a+="{"+i+"},",b+="isColor( "+i+", 85) and "}for(var j=0;j<e.length;j++)if(j+1<e.length){var k=e[j+1][0]-e[0][0],l=e[j+1][1]-e[0][1],m=e[j+1][2];c+=k+"|"+l+"|"+m+","}c="x,y = findMultiColorInRegionFuzzy("+e[0][2]+", "+c.substring(0,c.length-2)+", 90, 0, 0, 0, 0)",a="{"+a.substring(0,a.length-1)+"}",b="if ("+b.substring(0,b.length-4)+") then",$("#data-copy1").val(a),$("#data-copy2").val(b),$("#data-copy3").val(c)}function l(a){$(".color-list").css({border:"1px solid #333333","box-shadow":"none"}),a.css({border:"2px solid #ff0000","box-shadow":"0 0 2px #000 inset"});var b=a.attr("data-x")-8,c=a.attr("data-y")-8;C=b+r,D=c+s;var d=a.css("background-color");F=m(d),$("div[data-piex-info]").text(C+","+D+","+d+" , #"+F)}function m(a){var b=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);delete b[0];for(var c=1;3>=c;++c)b[c]=parseInt(b[c]).toString(16),1==b[c].length&&(b[c]="0"+b[c]);var d=b.join("");return d}var n,o,p=0,q=0,r=0,s=0,t="",u="",v="",w=!1,x=null,y=null,z=0,A=0,B=0,C=0,D=0,E=!1,F="";$(document).ready(function(){$("#fileUpload").change(function(a,c){var d=new FileReader;d.readAsDataURL(this.files[0]),d.onload=function(a){n=new Image,n.src=a.target.result,setTimeout(function(){var a=n.width+2,c=n.height+2;w=n.complete,x=document.getElementById("canvas"),o=$("#draw-box"),p=n.width,q=n.height;n.getAttribute("step");x.setAttribute("width",a+"px"),x.setAttribute("height",c+"px"),o.css({width:a+"px",height:c+"px"}),b(n,0,0)},500)}});var a=$("#color-peix"),m="";B=225;for(var r=0;B>r;r++){var s=Math.floor(r/15+1),t=Math.floor(r-15*(s-1)+1);m+='<li class="color-list" data-y='+s+" data-x="+t+"></li>"}a.html(m),$(document).keydown(function(a){var b=a.keyCode,c=f(b);if(c&&0==a.shiftKey)e(c);else{if(82==b&&a.ctrlKey)return d(),a.preventDefault(),!1;if(83==b&&a.ctrlKey)return $(".stop-draw").toggle(function(){E=!E}),a.preventDefault(),!1;if(c&&a.shiftKey){var h=$("#color-list"+c).find("span[data-clear-color]");return g(h),a.preventDefault(),!1}}}),$("#list-color-btn").click(function(){d()}),$("span[data-clear-color]").click(function(){var a=$(this);g(a)}),$("div[data-clear-all]").click(function(){h()}),$("div[data-rotate]").click(function(){i(j(this))}),$("#canvas").mousemove(function(a){var b=$(this);c(a,b)}),$("div[data-scprit]").click(function(){k()}),$(".color-list").click(function(a){l($(this))})})});